# gigers_lstm
This project aims to apply unsupervised learning methods on text data and utilise the resulting model for some useful applications. The dataset is a list of music news titles. The applications are the following:

* unsupervised clustering

* classification after an additional supervised training

* robust searching in the text

* to tell if two article titles are about the same subject (to be implemented)

Two methods are tested:

1. The first one is an LSTM based language model. A General Recurrent Neural Networks is used, with one LSTM cell to predict the next word in a sentence, given the previous words. After training the model is capable of finishing the learned sentences, based on the first words fed into the model.

2. The second one is an LSTM based autoencoder and classifier. First the sentence is encoded with an LSTM encoding RNN, then the state of the RNN is fed through a deep autoencoder, then the resulting state is given to an LSTM decoding RNN which tries to reconstruct the input sentence. After training the model is capable of transforming a given sentence into a dense code, which can be used for the mentioned applications. For example a classifier is built upon this code layer, and it is trained with an additional supervised learning.

## Code
Python version: 2.7.6
TensorFlow version: 0.8.0
The code is separated to 7 parts:

1. word2vec_gigers.py: reads the raw text data and creates a dictionary and the embeddings lookup table from it, using skip-gram model.

2. gigers_dataset_to_embeddings.py: reads the raw text data and converts the words to embeddings, using the embeddings lookup table and the dictionary.

3. music_news_labelled_dataset_to_embeddings.py reads the raw labelled text data and converts the words to embeddings, using the embeddings lookup table and the dictionary.

4. lstm_gigers.py: reads the embedded sentences, then trains and tests the LSTM language model.

5. lstm_autoencoder_gigers.py reads the embedded sentences, then trains and tests the LSTM autoencoder and saves the encoded sentences. It also trains the classifier.

6. kmeans.py: reads the encoded sentences, performs k-means clustering and saves the classes.

7. visualize_encoded_states.py reads the encoded sentences and the classes and visualizes them, using t-SNE.

Note: in the case when I took over code from other projects, it is mentioned in the first line of the script.

## Data
The dataset is a list of music news titles, collected from different blogs. The processed data files and a trained TensorFlow session is uploaded as well, completing the list of data files:

1. gigers_dataset.txt: raw text data of music news titles.

2. gigers_dataset_dictionary_embedding.pickle: pickle file containing the embedding lookup table, and the dictionary necessary to embed the text data. This file is the output of word2vec_gigers.py

3. gigers_dataset_embedded_100.pickle: 100 titles embedded to vectors. This file is the output of gigers_dataset_to_embeddings.py.

4. gigers_dataset_embedded_1000.zip: zipped pickle of 1000 titles embedded to vectors. This file is the output of gigers_dataset_to_embeddings.py.

5. music_news_dataset_labelled.pickle pickle file containing labelled music news titles. label: [0 1] -> news is about new music (album announcement, release, review, new video ect.), label: [1 0] -> news is not about new music.

6. music_news_dataset_labelled_embedded.zip.001 zipped pickle of the labelled embedded music news titles. This file is the output of music_news_labelled_dataset_to_embeddings.py

7. music_news_dataset_labelled_embedded.zip.002 zipped pickle of the labelled embedded music news titles. This file is the output of music_news_labelled_dataset_to_embeddings.py

8. autoencoder_trained.ckpt: a trained session for the LSTM autoencoder model, using 1000 news as training data.

9. autoencoder_trained.ckpt.meta meta graph for the trained session for the LSTM autoencoder model, using 1000 news as training data.

10. autoencoder_classifier_trained.ckpt a trained session for the LSTM autoencoder and classifier on labelled music news.

11. autoencoder_classifier_trained.ckpt.meta meta graph for the trained session for the LSTM autoencoder and classifier on labelled music news.

12. gigers_dataset_encoded_1000.pickle: 1000 encoded titles, the output of lstm_autoencoder_gigers.py.

13. gigers_dataset_kmeans_assignments_1000.pickle: the classes generated by k-means clustering, the output of kmeans.py.

14. gigers_dataset_encoded_1000_visualized.png: 1000 t-SNE visualized encoded titles, the k-means class information is colorcoded as well, the output of visualize_encoded_states.py.

## Results

### LSTM Language Model
Results after 100 news titles are 'learned':

#### Generate sentence from input words
Original title: <br />
flashback foo fighters cover tom pettys breakdown UNK UNK UNK UNK UNK UNK UNK UNK UNK UNK

Input words: <br />
flashback <br />
Predicted 6 further words: <br />
flashback watch randy travis duet with the

Input words: <br />
flashback foo fighters <br />
Predicted 4 further words: <br />
flashback watch fighters cover tom pettys breakdown

Input words: <br />
flashback foo fighters cover tom pettys <br />
Predicted 1 further word: <br />
flashback watch fighters cover tom pettys breakdown

### LSTM Autoencoder and Classifier
These examples are the results after 1000 titles 'learned' by the autoencoder, then 26000 labelled titles are used to train the classifier:

#### Generate sentence from input words

Input words: <br />
flashback foo fighters cover tom pettys <br />
Generated sentence: <br />
flashback foo fighters cover tom pettys breakdown burridge year usher arrests psa form watch listen berkeley ways us listen dacus listen stream watch to premiere rebels listen listen listen watch watch listen announcements co-owner anymore listen bittah 

Input words: <br />
flashback foo fighters tom pettys <br />
Generated sentence: <br />
flashback foo fighters cover tom pettys rejected connors hiring with stir concrete led endorsing concert-goers watch listen listen premiere manilow UNK the the spotifys listen listen premiere watch torches stream you ep to premiere listen listen watch

Input words: <br />
foo fighters tom pettys <br />
Generated sentence: <br />
exclusive grohl reveal underwood shoe crowd-funding eprom ernst with warned sumac watch falside stream 2014 premiere listen watch the involved stream premiere kygo watch you four-night iamnodobi harmonies listen listen bastille to sulaiman touche set listen listen 

Input words: <br />
foo fighters <br />
Generated sentence: <br />
guantanamera corporate lempel encased woodstock fighters with 11/20 of renaissance aarp rolled artwork listen ep hear scotty listen heart additions listen stream premiere centric 90 it to kidx stream on listen stream watch listen ep stream to

#### Search in the news

Search in the 1000 news titles and return the most relevant ones. The method is the following: <br />
All 1000 titles are encoded using the fully trained autoencoder. Then the search expression is encoded as well, the encoded search expression is compared to all the encoded titles, and the closest ones (cosine similarity) are selected as results.

Search expression: <br />
taylor swift shake it off <br />
Search results (top 7): <br />
'kendrick lamar sings freestyles over taylor swifts shake it off' <br />
'kendrick lamar sings taylor swift s shake it off   listen' <br />
'taylor swifts shake it off returns to no 1 on hot 100' <br />
'taylor swift shuns grand experiment of streaming music' <br />
'maison cartel   obsidian original mix free download' <br />
'kendrick lamar & taylor swift shout out each other s songs audio/video' <br />
'taylor swift collects fourth no 1 album now 52 debuts at no 2'

Search expression: <br />
ac/dc drummer murder <br />
Search results (top 7): <br />
'ac/dc drummer charged with hiring hitman to murder two people' <br />
'ac/dc drummer charged in murder plot' <br />
'hip-hop rumors did tiny join two black sororities pics' <br />
'hip-hop rumors can biggie s son spit or nah' <br />
'bono defends spotify lets experiment lets see what works' <br />
'jay z acquires armand de brignac' <br />
'metal injection livecast #280   metallicas some kind of monster dvd running commentary' <br />

Search expression: <br />
run the jewels 2 <br />
Search results (top 7): <br />
'run the jewels 2' <br />
'run the jewels run the jewels 2' <br />
'run the jewels run the jewels 2' <br />
'run the jewels deliver earth-shattering performance of early on letterman   watch' <br />
'run the jewels close your eyes and count to fuck ft zack de la rocha' <br />
'run the jewels how 2014s brashest rap duo came back from oblivion' <br />
'ought more than any other day' <br />

Search expression: <br />
jay z buys champagne brand <br />
Search results (top 7): <br />
'jay z buys ace of spades champagne brand' <br />
'jay z had a favorite champagne brand so he bought it' <br />
'jay z acquires armand de brignac' <br />
'jay z s favorite artist has a son that raps' <br />
'a hooligans az elso idei comet gyoztes' <br />
'zac brown on new album our boundaries have dissolved' <br />
'hip-hop rumors did tiny join two black sororities pics'

#### Classify

The classifier is trained to decide if the news title is about new music (videos / songs announced, released or reviewed) or not. A 90% accuracy can be achieved after training. Here are some results feeding in unlabelled data:

##### About new music

crackers david lowery unveils new country ballad talks upcoming double album
news listen to part of a new circa survive song
news we came as romans post  punk goes pop volume 6  studio video
news hand of mercy rise records play with fire in axis music video
news the downtown fiction debut santa cruz music video
news levi the poet streams lead single from  correspondence a fiction 
news listen to four new songs from wounds  upcoming album  die young 
news cobra starship release never been in love music video ft icona pop
news man overboard premiere new ep  passing ends 
feature single mothers runaways song premiere and free download

##### Not about new music

flashback foo fighters cover tom pettys breakdown
kanye west miguel to appear on lordes hunger games soundtrack
handwritten john lennon letter sells for $28000 at auction
liam gallagher reveals beady eye are no longer
ariana grande pharrell maroon 5 tabbed for grammy christmas special
taylor swift ariana grande and gwen stefani cover the hollywood bowl in glitter
wiz khalifa sparks up a more intimate party at blacc hollywood tour opener
cream bassist jack bruce dead at 71
sonic highways hits dc 5 things we learned
flashback watch randy travis duet with the avett brothers

### K-means Clustering Visualized
The 1000 training titles are encoded to 256 length vectors with the trained autoencoder, then a k-means clustering is performed on them. The high dimensional encoded titles are visualized using t-SNE, and the different colors represent different classes of the k-means clustering:

![alt tag](https://raw.githubusercontent.com/gergelyBognar/gigers_lstm/master/gigers_dataset_encoded_1000_visualized.png)
